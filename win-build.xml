<?xml version="1.0" encoding="UTF-8"?>
<project name="multibit" default="make-exe">
    <property name="build.dir" value="."/>

    <property file="win-build.properties"/>

    <target name="make-exe"  xmlns:fx="javafx:com.sun.javafx.tools.ant">
        <taskdef resource="com/sun/javafx/tools/ant/antlib.xml" uri="javafx:com.sun.javafx.tools.ant" classpath=".:package/windows:${jdk.home.1.7}/lib/ant-javafx.jar"/>

        <!-- Mark application as Swing-based --> 
        <fx:application id="multibitApp" mainClass="org.multibit.MultiBitInExecutableJar" toolkit="swing" name="MultiBit" version="0.5.14"/>

        <!-- Create executable jar file -->
        <fx:jar destfile="target/windows/multibit-win-exe.jar">
            <fileset dir="target/windows/multibit-exe.dir"/>
            <fx:application refid="multibitApp"/>
            <manifest> 
                <attribute name="Implementation-Vendor" value="multibit.org developers"/>
                <attribute name="Implementation-Title" value="multibit"/>
                <attribute name="Implementation-Version" value="0.5.14"/>
            </manifest> 
        </fx:jar>

       <!-- generate JNLPs, HTML and native bundles --> 
       <fx:deploy width="960" height="720" includeDT="true" 
                  nativeBundles="all" 
                  outdir="target-win" embedJNLP="true" verbose="true"
                  outfile="multibit">
            <fx:application refId="multibitApp"/>
            <fx:resources> 
                <fx:fileset dir="target/windows" includes="multibit-win-exe.jar"/>
                <fx:fileset dir="target/windows/staging" includes="**/*.*"/>
                <fx:fileset dir="${jdk.home.1.7}\\jre\\lib\\ext" includes="*.*"/>
                <fx:fileset dir="${jdk.home.1.7}\\jre\\lib\\ext" includes="*"/>
                <fx:fileset dir="package/windows" includes="license.rtf" type="license"/>
            </fx:resources>
            <fx:permissions/>
        </fx:deploy> 
    </target>
</project>
